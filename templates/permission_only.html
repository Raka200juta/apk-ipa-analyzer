{% extends "base.html" %}
{% block content %}
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Permission Analysis Report</title>
    <meta name="description" content="Permission Analysis Report">
    {% if host_os == 'windows' %}
        <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
    {% else %}
    <style>
      /* latin */
      @font-face {
        font-family: 'Open Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url('data:font/truetype;base64,{{ open_sans_b64 }}') format('truetype');
      }

      /* latin */
      @font-face {
        font-family: 'Oswald';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url('data:font/truetype;base64,{{ oswald_b64 }}') format('truetype');
      }
    </style>
    {% endif %}
    <style>
      {{ pdf_css | safe }}
    </style>
  </head>
  <body>
    <article id="cover">
      <div class="header">
        <div class="htext">ANDROID PERMISSION ANALYSIS REPORT</div>
      </div>
      </br></br></br>
      <div class="container">
        <table class="basic no_border">
          <tr class="no_border">
            <td class="no_border"><h3>File Name:</h3></td>
            <td class="no_border"><h3>{{file_name}}</h3></td>
          </tr>
          <tr>
            <td class="no_border"><h3>Package Name:</h3></td>
            <td class="no_border"><h3>{{ package_name }}</h3></td>
          </tr>
          <tr>
            <td class="no_border"><h3>Permission Security Score:</h3></td>
            <td class="no_border">
              <h2> 
                {% if permission_score < 30 %}
                  <span class="danger">{{ permission_score }}/100 (CRITICAL RISK)</span>
                {% elif permission_score < 40 %}
                  <span class="high">{{ permission_score }}/100 (HIGH RISK)</span>
                {% elif permission_score < 60 %}
                  <span class="warning">{{ permission_score }}/100 (MEDIUM RISK)</span>
                {% else %}
                  <span class="success">{{ permission_score }}/100 (LOW RISK)</span>
                {% endif %}
              </h2>
            </td>
          </tr>
          <tr>
            <td class="no_border"><h3>Total Permissions:</h3></td>
            <td class="no_border"><h3>{{ total_permissions }}</h3></td>
          </tr>
          <tr>
            <td class="no_border"><h3>Dangerous Permissions:</h3></td>
            <td class="no_border"><h3>{{ dangerous_permissions_count }}</h3></td>
          </tr>
        </table>
      </div>
    </article>

    <article id="contents">
      <h2>PERMISSION ANALYSIS</h2>
      
      <div class="section">
        <h3>Overview</h3>
        <p>{{ permission_summary }}</p>
      </div>

      {% if dangerous_permissions %}
      <div class="section">
        <h3>DANGEROUS PERMISSIONS</h3>
        <table class="basic">
          <thead>
            <tr>
              <th>PERMISSION</th>
              <th>DESCRIPTION</th>
            </tr>
          </thead>
          <tbody>
            {% for perm in dangerous_permissions %}
            <tr>
              <td><span class="danger">{{ perm.name }}</span></td>
              <td>{{ perm.description }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% endif %}

      <div class="section">
        <h3>ALL PERMISSIONS</h3>
        <table class="basic">
          <thead>
            <tr>
              <th>PERMISSION</th>
              <th>STATUS</th>
              <th>DESCRIPTION</th>
            </tr>
          </thead>
          <tbody>
            {% for perm in permissions %}
            <tr>
              <td>{{ perm.name }}</td>
              <td>
                {% if perm.status == 'dangerous' %}
                  <span class="danger">dangerous</span>
                {% elif perm.status == 'normal' %}
                  <span class="info">normal</span>
                {% elif perm.status == 'signatureOrSystem' %}
                  <span class="warning">SignatureOrSystem</span>
                {% elif perm.status == 'signature' %}
                  <span class="success">signature</span>
                {% else %}
                  <span class="secondary">unknown</span>
                {% endif %}
              </td>
              <td>{{ perm.description }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </article>

    <article id="columns">
      <hr>
      <section>
        <p>
          <strong>Â© {% now "Y" %} | Android Permission Analysis Report</strong>
        </p>
      </section>
    </article>
  </body>
</html>
{% endblock %}